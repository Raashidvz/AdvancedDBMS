CREATE TABLE Department( DeptID INT PRIMARY KEY AUTO_INCREMENT, DeptName VARCHAR(50) NOT NULL, Location VARCHAR(100));

CREATE TABLE Employees( EmpID INT PRIMARY KEY AUTO_INCREMENT, FirstName VARCHAR(50) NOT NULL, LastName VARCHAR(50) NOT NULL, DeptID INT, Salary DECIMAL(10,2), HireDate DATE DEFAULT CURRENT_DATE, JobTitle VARCHAR(50), FOREIGN KEY(DeptID) REFERENCES Department(DeptID));

PART 1:
1. INSERT INTO Department VALUES (7,'Engineering','San Francisco');
   INSERT INTO Department (DeptName,Location) VALUES ('HR','Chicago'),('Sales','London'),('Marketing','Austin'),('Operations','Boston'),('Research','Boston');
   
2. INSERT INTO Employees(EmpID,FirstName,LastName,JobTitle,Salary) VALUES (101,'Alice','Johnson','Analyst',65000);
3. INSERT INTO Employees (FirstName,LastName,DeptID) VALUES ('Rahul','Raj',(SELECT DeptID FROM Department WHERE DeptName='Sales'));
4. INSERT INTO Employees(FirstName, LastName, Salary) VALUES ('Tarzon','Davis',5000*12);
5. INSERT INTO Employees(FirstName,LastName,JobTitle) VALUES ('Zohan','Haibin','Trainee'),('Jakes','Samuel','Trainee'),('Alex','Thomas','Trainee');
6. INSERT INTO Employees(EmpID,FirstName,LastName,Salary) VALUES (201,'Tovino','Thomas',65000);
7. CREATE TABLE Emp_Backup AS SELECT * FROM Employees;
8. INSERT INTO Employees (FirstName,LastName,DeptID) VALUES ('Dulqer','Salman',(SELECT DeptID FROM Department WHERE DeptName = 'Marketing'));
9. INSERT INTO Employees (EmpID,FirstName,LastName) VALUES (101,'Mahesh','Babu');
	ERROR 1062 (23000): Duplicate entry '101' for key 'PRIMARY'
10. INSERT INTO Employees (FirstName,LastName,HireDate) VALUES ('Allu','Arjun',CURDATE());


PART 2:
   UPDATE Employees SET DeptID=(SELECT DeptID FROM Department WHERE DeptName='Engineering') WHERE Salary IS NOT NULL;
1. UPDATE Employees SET Salary = Salary*1.10 WHERE DeptID=(SELECT DeptID FROM Department WHERE DeptName='Engineering');
2. UPDATE Employees SET JobTitle='Senior Analyst' WHERE EmpID=101;
3. UPDATE Department SET Location='New York' WHERE DeptName='HR';
4. UPDATE Employees SET Salary=30000 WHERE Salary IS NULL;
5. UPDATE Employees SET LastName='Smith-West' WHERE EmpID=105;
6. UPDATE Employees SET Salary=Salary+5000 WHERE EmpID IN (SELECT EmpID FROM (SELECT * FROM Employees ORDER BY Salary ASC LIMIT 5) AS t);
7. UPDATE Employees SET DeptID=(SELECT DeptID FROM Department WHERE DeptName='Operations') WHERE JobTitle='Manager';
8. UPDATE Employees SET Salary=50000, JobTitle='Ex Analyst' WHERE EmpID=101;
9. UPDATE Employees SET JobTitle = CONCAT('Global', JobTitle) WHERE DeptID = (Select DeptID FROM Department WHERE DeptName='Sales');
10. UPDATE Employees e SET Salary=(SELECT AVG(Salary) FROM Employees WHERE DeptID = e.DeptID);


Part 3:
1. DELETE FROM Employees WHERE EmpID=101;
2. DELETE FROM Employees WHERE HireDate < '2010-01-01';
3. UPDATE Employees SET DeptID=NULL WHERE DeptID IN( SELECT DeptID FROM Department WHERE Location='Chicago');
DELETE FROM Department WHERE location = 'Chicago';
4. DELETE FROM Employees WHERE DeptID IS NULL;
5. 
6. DELETE FROM Department WHERE DeptName='Marketing';
7. DELETE FROM Employees WHERE Salary < 25000;
8. DELETE FROM Employees WHERE DeptID=(SELECT DeptID FROM Department WHERE DeptName='Sales');
9. Truncate Emp_Backup;
10. DELETE FROM Employees WHERE Salary=(SELECT MAX(Salary) FROM Employees);
